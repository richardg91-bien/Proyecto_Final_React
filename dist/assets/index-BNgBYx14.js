import{j as e,F as s,B as a,M as i,C as n,T as r}from"./bootstrap-vendor-DtCbQ1rc.js";import{r as t,R as l}from"./react-vendor-DhwnvXGV.js";import{y as c}from"./ui-vendor-Bh1mUo_i.js";import{P as o,d,e as m,u as h,S as x,f as u,g as j,h as p,i as b,j as f,k as g,l as y}from"./index-CkGa0Hy8.js";import{E as N}from"./index-CYQFgh7D.js";import{S as v}from"./index-wKJVR9Av.js";import"./icons-vendor-CNWg5Z-e.js";const k=()=>{const e=t.useContext(o);if(!e)throw new Error("useProductsContext must be used within a ProductsProvider");return e},F=({onClose:i,editProduct:n=null,mode:r="add"})=>{const{agregarProducto:l,editarProducto:o}=k(),[h,x]=t.useState({nombre:"",precio:"",descripcion:"",imagen:"",stock:""}),[u,j]=t.useState({}),[p,b]=t.useState(!1);t.useEffect(()=>{"edit"===r&&n&&x({nombre:n.name||n.title||"",precio:n.price||"",descripcion:n.description||"",imagen:n.img||n.image||"",stock:n.stock||"0"})},[r,n]);const f=e=>{const{name:s,value:a}=e.target;x(e=>({...e,[s]:a})),u[s]&&j(e=>({...e,[s]:""}))};return e.jsxs("div",{className:"product-form",children:[u.submit&&e.jsxs(Alert,{variant:"danger",className:"mb-4",children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),u.submit]}),e.jsxs(s,{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};h.nombre.trim()||(e.nombre="El nombre del producto es obligatorio"),h.precio?parseFloat(h.precio)<=0?e.precio="El precio debe ser mayor a 0":isNaN(parseFloat(h.precio))&&(e.precio="El precio debe ser un nÃºmero vÃ¡lido"):e.precio="El precio es obligatorio",h.descripcion.trim()?h.descripcion.trim().length<10&&(e.descripcion="La descripciÃ³n debe tener al menos 10 caracteres"):e.descripcion="La descripciÃ³n es obligatoria",h.imagen&&h.imagen.trim()&&(/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(h.imagen.trim())||(e.imagen="Debe ser una URL vÃ¡lida (ej: https://ejemplo.com/imagen.jpg)"));if(h.stock&&h.stock.trim()){const s=parseInt(h.stock);(isNaN(s)||s<0)&&(e.stock="El stock debe ser un nÃºmero entero mayor o igual a 0")}return j(e),0===Object.keys(e).length})()){b(!0);try{if(await new Promise(e=>setTimeout(e,1e3)),"edit"===r&&n)o(n.id,h),c.success(`Â¡Producto "${h.nombre}" actualizado correctamente!`,{icon:"âœ…"});else{l(h);c.success(`Â¡Producto "${h.nombre}" agregado correctamente!`,{icon:"âœ¨"})}"add"===r&&x({nombre:"",precio:"",descripcion:"",imagen:"",stock:""}),setTimeout(()=>{i&&i()},1500)}catch(s){c.error("Error al procesar el producto. IntÃ©ntalo de nuevo."),j({submit:"Error al procesar el producto. IntÃ©ntalo de nuevo."})}finally{b(!1)}}},children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{htmlFor:"nombre",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Nombre del Producto *"}),e.jsx(s.Control,{type:"text",id:"nombre",name:"nombre",value:h.nombre,onChange:f,isInvalid:!!u.nombre,isValid:h.nombre.trim()&&!u.nombre,placeholder:"Ingresa el nombre del producto",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(s.Control.Feedback,{type:"invalid",children:u.nombre}),e.jsx(s.Control.Feedback,{type:"valid",children:"Â¡Nombre vÃ¡lido!"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{htmlFor:"precio",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Precio ($) *"}),e.jsx(s.Control,{type:"number",step:"0.01",min:"0",id:"precio",name:"precio",value:h.precio,onChange:f,isInvalid:!!u.precio,isValid:h.precio&&parseFloat(h.precio)>0&&!u.precio,placeholder:"0.00",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(s.Control.Feedback,{type:"invalid",children:u.precio}),e.jsx(s.Control.Feedback,{type:"valid",children:"Â¡Precio vÃ¡lido!"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{htmlFor:"descripcion",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"DescripciÃ³n *"}),e.jsx(s.Control,{as:"textarea",rows:4,id:"descripcion",name:"descripcion",value:h.descripcion,onChange:f,isInvalid:!!u.descripcion,isValid:h.descripcion.trim().length>=10&&!u.descripcion,placeholder:"Describe el producto (mÃ­nimo 10 caracteres)",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(s.Control.Feedback,{type:"invalid",children:u.descripcion}),e.jsx(s.Control.Feedback,{type:"valid",children:"Â¡DescripciÃ³n vÃ¡lida!"}),e.jsxs(s.Text,{className:"text-muted",children:[h.descripcion.length,"/10 caracteres mÃ­nimos"]})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{htmlFor:"imagen",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"URL de la Imagen"}),e.jsx(s.Control,{type:"url",id:"imagen",name:"imagen",value:h.imagen,onChange:f,isInvalid:!!u.imagen,isValid:h.imagen.trim()&&!u.imagen,placeholder:"https://ejemplo.com/imagen.jpg",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(s.Control.Feedback,{type:"invalid",children:u.imagen}),e.jsx(s.Control.Feedback,{type:"valid",children:"Â¡URL vÃ¡lida!"}),e.jsx(s.Text,{className:"text-muted",children:"URL completa de la imagen del producto (opcional)"})]}),e.jsxs(s.Group,{className:"mb-4",children:[e.jsx(s.Label,{htmlFor:"stock",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Stock Disponible"}),e.jsx(s.Control,{type:"number",min:"0",id:"stock",name:"stock",value:h.stock,onChange:f,isInvalid:!!u.stock,isValid:h.stock&&parseInt(h.stock)>=0&&!u.stock,placeholder:"0",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(s.Control.Feedback,{type:"invalid",children:u.stock}),e.jsx(s.Control.Feedback,{type:"valid",children:"Â¡Stock vÃ¡lido!"}),e.jsx(s.Text,{className:"text-muted",children:"Cantidad disponible en inventario (opcional)"})]}),e.jsxs("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:[e.jsx(a,{type:"submit",variant:"primary",disabled:p,className:"me-md-2",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-label":"Procesando"}),"edit"===r?"Actualizando...":"Agregando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"me-2"}),"edit"===r?"Actualizar Producto":"Agregar Producto"]})}),i&&e.jsxs(a,{type:"button",variant:"outline-secondary",onClick:i,disabled:p,style:{fontFamily:"Quicksand, sans-serif"},"aria-label":"Cancelar",children:[e.jsx(m,{className:"me-2"}),"Cancelar"]})]})]})]})},w=({show:s,onHide:n,onConfirm:r,productName:t,isDeleting:l})=>e.jsxs(i,{show:s,onHide:n,size:"md",centered:!0,backdrop:"static",children:[e.jsx(i.Header,{closeButton:!0,children:e.jsxs(i.Title,{style:{fontFamily:"Lato, sans-serif"},children:[e.jsx("i",{className:"bi bi-exclamation-triangle text-warning me-2"}),"Confirmar EliminaciÃ³n"]})}),e.jsx(i.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"bi bi-trash text-danger mb-3",style:{fontSize:"3rem"}}),e.jsx("h5",{className:"mb-3",style:{fontFamily:"Quicksand, sans-serif"},children:"Â¿EstÃ¡s seguro que deseas eliminar este producto?"}),e.jsxs("p",{className:"text-muted mb-4",style:{fontFamily:"Quicksand, sans-serif"},children:[e.jsxs("strong",{children:['"',t,'"']}),e.jsx("br",{}),"Esta acciÃ³n no se puede deshacer."]})]})}),e.jsxs(i.Footer,{className:"d-flex justify-content-center gap-3",children:[e.jsxs(a,{variant:"outline-secondary",onClick:n,disabled:l,style:{fontFamily:"Quicksand, sans-serif"},children:[e.jsx("i",{className:"bi bi-x-circle me-2"}),"Cancelar"]}),e.jsx(a,{variant:"danger",onClick:r,disabled:l,style:{fontFamily:"Quicksand, sans-serif"},children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Eliminando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-trash me-2"}),"Eliminar Producto"]})})]})]}),C=()=>{const{user:s}=h(),{products:o,loading:d,error:m,eliminarProducto:C,esProductoEditable:P,refetch:S}=k(),[Q,E]=t.useState(!1),[z,L]=t.useState(!1),[A,I]=t.useState(null),[W,$]=t.useState(!1),[B,D]=t.useState(null),[T,U]=t.useState("add"),[G,H]=t.useState({totalProducts:0,totalSales:0,totalUsers:0,pendingOrders:0});return l.useEffect(()=>{o&&o.length>0&&H({totalProducts:o.length,totalSales:Math.floor(1e4*Math.random())+5e3,totalUsers:Math.floor(500*Math.random())+100,pendingOrders:Math.floor(50*Math.random())+5})},[o]),d?e.jsx(x,{message:"Cargando panel de administraciÃ³n..."}):m?e.jsx(N,{message:m,onRetry:S}):e.jsxs(e.Fragment,{children:[e.jsx(v,{title:"Panel de AdministraciÃ³n",description:"Gestiona productos, inventario y pedidos desde el panel de administraciÃ³n de Indumentaria Agat.",keywords:"admin, administraciÃ³n, panel, gestiÃ³n, productos"}),e.jsxs("div",{className:"admin-page bg-light min-vh-100",children:[e.jsx("div",{className:"container py-5",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"h2 fw-bold mb-1",style:{color:"rgba(0,0,0,0.8)",fontFamily:"Lato, sans-serif"},children:"Panel de AdministraciÃ³n"}),e.jsxs("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:["Bienvenido, ",s?.name]})]}),e.jsxs("div",{className:"badge bg-success px-3 py-2",children:[e.jsx(FaShieldAlt,{className:"me-2"}),"Administrador"]})]}),e.jsxs("div",{className:"row mb-5",children:[e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(n,{className:"border-0 shadow-sm h-100",children:e.jsxs(n.Body,{className:"text-center",children:[e.jsx(u,{className:"text-primary mb-3",style:{fontSize:"3rem"}}),e.jsx("h3",{className:"h4 fw-bold",children:G.totalProducts}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Productos"})]})})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(n,{className:"border-0 shadow-sm h-100",children:e.jsxs(n.Body,{className:"text-center",children:[e.jsx(j,{className:"text-success mb-3",style:{fontSize:"3rem"}}),e.jsxs("h3",{className:"h4 fw-bold",children:["$",G.totalSales.toLocaleString()]}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Ventas Totales"})]})})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(n,{className:"border-0 shadow-sm h-100",children:e.jsxs(n.Body,{className:"text-center",children:[e.jsx(p,{className:"text-info mb-3",style:{fontSize:"3rem"}}),e.jsx("h3",{className:"h4 fw-bold",children:G.totalUsers}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Usuarios"})]})})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(n,{className:"border-0 shadow-sm h-100",children:e.jsxs(n.Body,{className:"text-center",children:[e.jsx(b,{className:"text-warning mb-3",style:{fontSize:"3rem"}}),e.jsx("h3",{className:"h4 fw-bold",children:G.pendingOrders}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Pedidos Pendientes"})]})})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs(n,{className:"border-0 shadow-sm",children:[e.jsx(n.Header,{className:"bg-white border-bottom",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"h5 mb-0",style:{fontFamily:"Lato, sans-serif"},children:"GestiÃ³n de Productos"}),e.jsxs(a,{variant:"primary",size:"sm",onClick:()=>{U("add"),D(null),E(!0)},"aria-label":"Agregar nuevo producto",children:[e.jsx(f,{className:"me-2"}),"Nuevo Producto"]})]})}),e.jsx(n.Body,{className:"p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs(r,{className:"mb-0",hover:!0,children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"ID"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Producto"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"CategorÃ­a"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Precio"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Stock"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Acciones"})]})}),e.jsx("tbody",{children:o.slice(0,10).map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("small",{className:"text-muted",children:["#",s.id]})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:s.img,alt:s.name,style:{width:"40px",height:"40px",objectFit:"cover"},className:"rounded me-3"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:s.name.length>30?`${s.name.substring(0,30)}...`:s.name}),s.id>1e12&&e.jsx("small",{className:"badge bg-primary ms-1",children:"NUEVO"})]})]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light text-dark",children:s.category})}),e.jsx("td",{children:e.jsxs("span",{className:"fw-bold text-success",children:["$",s.price]})}),e.jsx("td",{children:void 0!==s.stock?e.jsx("span",{className:"badge "+(s.stock>0?"bg-success":"bg-warning text-dark"),children:s.stock>0?`${s.stock} unidades`:"Sin stock"}):e.jsx("span",{className:"badge bg-secondary",children:"No definido"})}),e.jsx("td",{children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx(a,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{U("edit"),D(e),E(!0)})(s),title:"Editar producto","aria-label":`Editar ${s.name}`,children:e.jsx(g,{})}),P(s.id)&&e.jsx(a,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{I(e),L(!0)})(s),title:"Eliminar producto","aria-label":`Eliminar ${s.name}`,children:e.jsx(y,{})})]})})]},s.id))})]})})}),e.jsx(n.Footer,{className:"bg-light text-center",children:e.jsxs("small",{className:"text-muted",style:{fontFamily:"Quicksand, sans-serif"},children:["Mostrando 10 de ",o.length," productos"]})})]})})}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsxs(n,{className:"border-0 shadow-sm",children:[e.jsx(n.Header,{className:"bg-white",children:e.jsx("h5",{className:"mb-0",style:{fontFamily:"Lato, sans-serif"},children:"Acciones RÃ¡pidas"})}),e.jsx(n.Body,{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs(a,{variant:"outline-primary",className:"w-100 py-3",onClick:()=>alert("Funcionalidad en desarrollo"),children:[e.jsx("i",{className:"bi bi-file-earmark-text d-block mb-2",style:{fontSize:"2rem"}}),"Generar Reporte"]})}),e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs(a,{variant:"outline-success",className:"w-100 py-3",onClick:()=>S(),children:[e.jsx("i",{className:"bi bi-arrow-clockwise d-block mb-2",style:{fontSize:"2rem"}}),"Actualizar Datos"]})}),e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs(a,{variant:"outline-warning",className:"w-100 py-3",onClick:()=>alert("Funcionalidad en desarrollo"),children:[e.jsx("i",{className:"bi bi-gear d-block mb-2",style:{fontSize:"2rem"}}),"ConfiguraciÃ³n"]})})]})})]})})})]})})}),e.jsxs(i,{show:Q,onHide:()=>E(!1),size:"lg",centered:!0,backdrop:"static",children:[e.jsx(i.Header,{closeButton:!0,children:e.jsxs(i.Title,{style:{fontFamily:"Lato, sans-serif"},children:[e.jsx("i",{className:`bi ${"edit"===T?"bi-pencil-square":"bi-plus-circle"} me-2`}),"edit"===T?"Editar Producto":"Agregar Nuevo Producto"]})}),e.jsx(i.Body,{className:"p-4",children:e.jsx(F,{mode:T,editProduct:B,onClose:()=>{E(!1),D(null),U("add")}})})]}),e.jsx(w,{show:z,onHide:()=>{L(!1),I(null)},onConfirm:async()=>{if(A){$(!0);try{await new Promise(e=>setTimeout(e,1e3)),C(A.id),c.success(`Producto "${A.name}" eliminado correctamente`,{icon:"ğŸ—‘ï¸"})}catch(e){c.error("Error al eliminar el producto. Intenta nuevamente.")}finally{$(!1),L(!1),I(null)}}},productName:A?.name||A?.title||"",isDeleting:W})]})]})};export{C as default};

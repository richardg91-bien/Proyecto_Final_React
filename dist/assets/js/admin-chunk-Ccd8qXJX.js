import{j as e}from"./react-jsx-BHrkn65s.js";import{r as s,R as i}from"./react-BlGBNzmT.js";import{H as a}from"./ui-libs-CMC0-5Gq.js";import{A as t,P as n}from"./app-context-CeLer4GA.js";import{B as l,A as r,F as c,M as o,C as d,T as m,a as h,b as x}from"./bootstrap-Bz9xP46s.js";const u=({message:s="Cargando productos..."})=>e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary mb-3",role:"status",style:{width:"3rem",height:"3rem"},children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"text-muted fs-5",style:{fontFamily:"Lato, sans-serif"},children:s})]}),j=({message:s="Error al cargar productos. Inténtalo más tarde.",onRetry:i=null})=>e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center py-5",children:[e.jsxs("div",{className:"alert alert-danger text-center mb-4",style:{maxWidth:"500px"},children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2 fs-4"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h5",{className:"alert-heading",children:"¡Oops! Algo salió mal"}),e.jsx("p",{className:"mb-0",style:{fontFamily:"Lato, sans-serif"},children:s})]})]}),i&&e.jsxs(l,{variant:"outline-primary",onClick:i,className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-arrow-clockwise"}),"Intentar nuevamente"]})]}),b=()=>{const e=s.useContext(t);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},p=()=>{const e=s.useContext(n);if(!e)throw new Error("useProductsContext must be used within a ProductsProvider");return e},f=({onClose:i,editProduct:a=null,mode:t="add"})=>{const{agregarProducto:n,editarProducto:o}=p(),[d,m]=s.useState({nombre:"",precio:"",descripcion:"",imagen:"",stock:""}),[h,x]=s.useState({}),[u,j]=s.useState(!1),[b,f]=s.useState(!1);s.useEffect(()=>{"edit"===t&&a&&m({nombre:a.name||a.title||"",precio:a.price||"",descripcion:a.description||"",imagen:a.img||a.image||"",stock:a.stock||"0"})},[t,a]);const g=e=>{const{name:s,value:i}=e.target;m(e=>({...e,[s]:i})),h[s]&&x(e=>({...e,[s]:""}))};return e.jsxs("div",{className:"product-form",children:[b&&e.jsxs(r,{variant:"success",className:"mb-4",children:[e.jsx("i",{className:"bi bi-check-circle-fill me-2"}),"edit"===t?"¡Producto editado exitosamente!":"¡Producto agregado exitosamente!"]}),h.submit&&e.jsxs(r,{variant:"danger",className:"mb-4",children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),h.submit]}),e.jsxs(c,{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};if(d.nombre.trim()||(e.nombre="El nombre del producto es obligatorio"),d.precio?parseFloat(d.precio)<=0?e.precio="El precio debe ser mayor a 0":isNaN(parseFloat(d.precio))&&(e.precio="El precio debe ser un número válido"):e.precio="El precio es obligatorio",d.descripcion.trim()?d.descripcion.trim().length<10&&(e.descripcion="La descripción debe tener al menos 10 caracteres"):e.descripcion="La descripción es obligatoria",d.imagen&&d.imagen.trim()&&(/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(d.imagen.trim())||(e.imagen="Debe ser una URL válida (ej: https://ejemplo.com/imagen.jpg)")),d.stock&&d.stock.trim()){const s=parseInt(d.stock);(isNaN(s)||s<0)&&(e.stock="El stock debe ser un número entero mayor o igual a 0")}return x(e),0===Object.keys(e).length})()){j(!0);try{await new Promise(e=>setTimeout(e,1e3)),"edit"===t&&a?o(a.id,d):n(d),f(!0),"add"===t&&m({nombre:"",precio:"",descripcion:"",imagen:"",stock:""}),setTimeout(()=>{f(!1),i&&i()},3e3)}catch(s){x({submit:"Error al procesar el producto. Inténtalo de nuevo."})}finally{j(!1)}}},children:[e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{htmlFor:"nombre",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Nombre del Producto *"}),e.jsx(c.Control,{type:"text",id:"nombre",name:"nombre",value:d.nombre,onChange:g,isInvalid:!!h.nombre,isValid:d.nombre.trim()&&!h.nombre,placeholder:"Ingresa el nombre del producto",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(c.Control.Feedback,{type:"invalid",children:h.nombre}),e.jsx(c.Control.Feedback,{type:"valid",children:"¡Nombre válido!"})]}),e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{htmlFor:"precio",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Precio ($) *"}),e.jsx(c.Control,{type:"number",step:"0.01",min:"0",id:"precio",name:"precio",value:d.precio,onChange:g,isInvalid:!!h.precio,isValid:d.precio&&parseFloat(d.precio)>0&&!h.precio,placeholder:"0.00",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(c.Control.Feedback,{type:"invalid",children:h.precio}),e.jsx(c.Control.Feedback,{type:"valid",children:"¡Precio válido!"})]}),e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{htmlFor:"descripcion",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Descripción *"}),e.jsx(c.Control,{as:"textarea",rows:4,id:"descripcion",name:"descripcion",value:d.descripcion,onChange:g,isInvalid:!!h.descripcion,isValid:d.descripcion.trim().length>=10&&!h.descripcion,placeholder:"Describe el producto (mínimo 10 caracteres)",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(c.Control.Feedback,{type:"invalid",children:h.descripcion}),e.jsx(c.Control.Feedback,{type:"valid",children:"¡Descripción válida!"}),e.jsxs(c.Text,{className:"text-muted",children:[d.descripcion.length,"/10 caracteres mínimos"]})]}),e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{htmlFor:"imagen",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"URL de la Imagen"}),e.jsx(c.Control,{type:"url",id:"imagen",name:"imagen",value:d.imagen,onChange:g,isInvalid:!!h.imagen,isValid:d.imagen.trim()&&!h.imagen,placeholder:"https://ejemplo.com/imagen.jpg",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(c.Control.Feedback,{type:"invalid",children:h.imagen}),e.jsx(c.Control.Feedback,{type:"valid",children:"¡URL válida!"}),e.jsx(c.Text,{className:"text-muted",children:"URL completa de la imagen del producto (opcional)"})]}),e.jsxs(c.Group,{className:"mb-4",children:[e.jsx(c.Label,{htmlFor:"stock",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Stock Disponible"}),e.jsx(c.Control,{type:"number",min:"0",id:"stock",name:"stock",value:d.stock,onChange:g,isInvalid:!!h.stock,isValid:d.stock&&parseInt(d.stock)>=0&&!h.stock,placeholder:"0",style:{fontFamily:"Quicksand, sans-serif"}}),e.jsx(c.Control.Feedback,{type:"invalid",children:h.stock}),e.jsx(c.Control.Feedback,{type:"valid",children:"¡Stock válido!"}),e.jsx(c.Text,{className:"text-muted",children:"Cantidad disponible en inventario (opcional)"})]}),e.jsxs("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:[e.jsx(l,{type:"submit",variant:"primary",disabled:u,className:"me-md-2",style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"edit"===t?"Actualizando...":"Agregando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:`bi ${"edit"===t?"bi-pencil-square":"bi-plus-circle"} me-2`}),"edit"===t?"Actualizar Producto":"Agregar Producto"]})}),i&&e.jsx(l,{type:"button",variant:"outline-secondary",onClick:i,disabled:u,style:{fontFamily:"Quicksand, sans-serif"},children:"Cancelar"})]})]})]})},g=({show:s,onHide:i,onConfirm:a,productName:t,isDeleting:n})=>e.jsxs(o,{show:s,onHide:i,size:"md",centered:!0,backdrop:"static",children:[e.jsx(o.Header,{closeButton:!0,children:e.jsxs(o.Title,{style:{fontFamily:"Lato, sans-serif"},children:[e.jsx("i",{className:"bi bi-exclamation-triangle text-warning me-2"}),"Confirmar Eliminación"]})}),e.jsx(o.Body,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"bi bi-trash text-danger mb-3",style:{fontSize:"3rem"}}),e.jsx("h5",{className:"mb-3",style:{fontFamily:"Quicksand, sans-serif"},children:"¿Estás seguro que deseas eliminar este producto?"}),e.jsxs("p",{className:"text-muted mb-4",style:{fontFamily:"Quicksand, sans-serif"},children:[e.jsxs("strong",{children:['"',t,'"']}),e.jsx("br",{}),"Esta acción no se puede deshacer."]})]})}),e.jsxs(o.Footer,{className:"d-flex justify-content-center gap-3",children:[e.jsxs(l,{variant:"outline-secondary",onClick:i,disabled:n,style:{fontFamily:"Quicksand, sans-serif"},children:[e.jsx("i",{className:"bi bi-x-circle me-2"}),"Cancelar"]}),e.jsx(l,{variant:"danger",onClick:a,disabled:n,style:{fontFamily:"Quicksand, sans-serif"},children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Eliminando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-trash me-2"}),"Eliminar Producto"]})})]})]}),y=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{user:t}=b(),{products:n,loading:r,error:c,eliminarProducto:y,esProductoEditable:N,refetch:v}=p(),[k,F]=s.useState(!1),[w,C]=s.useState(!1),[P,S]=s.useState(!1),[Q,E]=s.useState(null),[A,L]=s.useState(!1),[z,I]=s.useState(null),[W,B]=s.useState("add"),[T,D]=s.useState(null),[H,M]=s.useState({totalProducts:0,totalSales:0,totalUsers:0,pendingOrders:0});return i.useEffect(()=>{n&&n.length>0&&M({totalProducts:n.length,totalSales:Math.floor(1e4*Math.random())+5e3,totalUsers:Math.floor(500*Math.random())+100,pendingOrders:Math.floor(50*Math.random())+5})},[n]),r?e.jsx(u,{message:"Cargando panel de administración..."}):c?e.jsx(j,{message:c,onRetry:v}):e.jsxs(e.Fragment,{children:[e.jsxs(a,{children:[e.jsx("title",{children:"Panel de Administración - Indumentaria Agat"}),e.jsx("meta",{name:"description",content:"Panel de administración de Indumentaria Agat. Gestión de productos, inventario y configuración de la tienda."}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("div",{className:"admin-page bg-light min-vh-100",children:[e.jsx("div",{className:"container py-5",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"h2 fw-bold mb-1",style:{color:"rgba(0,0,0,0.8)",fontFamily:"Lato, sans-serif"},children:"Panel de Administración"}),e.jsxs("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:["Bienvenido, ",t?.name]})]}),e.jsxs("div",{className:"badge bg-success px-3 py-2",children:[e.jsx("i",{className:"bi bi-shield-check me-2"}),"Administrador"]})]}),e.jsxs("div",{className:"row mb-5",children:[e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(d,{className:"border-0 shadow-sm h-100",children:e.jsxs(d.Body,{className:"text-center",children:[e.jsx("i",{className:"bi bi-box-seam text-primary mb-3",style:{fontSize:"3rem"}}),e.jsx("h3",{className:"h4 fw-bold",children:H.totalProducts}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Productos"})]})})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(d,{className:"border-0 shadow-sm h-100",children:e.jsxs(d.Body,{className:"text-center",children:[e.jsx("i",{className:"bi bi-graph-up text-success mb-3",style:{fontSize:"3rem"}}),e.jsxs("h3",{className:"h4 fw-bold",children:["$",H.totalSales.toLocaleString()]}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Ventas Totales"})]})})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(d,{className:"border-0 shadow-sm h-100",children:e.jsxs(d.Body,{className:"text-center",children:[e.jsx("i",{className:"bi bi-people text-info mb-3",style:{fontSize:"3rem"}}),e.jsx("h3",{className:"h4 fw-bold",children:H.totalUsers}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Usuarios"})]})})}),e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx(d,{className:"border-0 shadow-sm h-100",children:e.jsxs(d.Body,{className:"text-center",children:[e.jsx("i",{className:"bi bi-clock text-warning mb-3",style:{fontSize:"3rem"}}),e.jsx("h3",{className:"h4 fw-bold",children:H.pendingOrders}),e.jsx("p",{className:"text-muted mb-0",style:{fontFamily:"Quicksand, sans-serif"},children:"Pedidos Pendientes"})]})})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs(d,{className:"border-0 shadow-sm",children:[e.jsx(d.Header,{className:"bg-white border-bottom",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"h5 mb-0",style:{fontFamily:"Lato, sans-serif"},children:"Gestión de Productos"}),e.jsxs(l,{variant:"primary",size:"sm",onClick:()=>{B("add"),I(null),F(!0)},children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Nuevo Producto"]})]})}),e.jsx(d.Body,{className:"p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs(m,{className:"mb-0",hover:!0,children:[e.jsx("thead",{className:"bg-light",children:e.jsxs("tr",{children:[e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"ID"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Producto"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Categoría"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Precio"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Stock"}),e.jsx("th",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:"Acciones"})]})}),e.jsx("tbody",{children:n.slice(0,10).map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("small",{className:"text-muted",children:["#",s.id]})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:s.img,alt:s.name,style:{width:"40px",height:"40px",objectFit:"cover"},className:"rounded me-3"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"Quicksand, sans-serif",fontWeight:"600"},children:s.name.length>30?`${s.name.substring(0,30)}...`:s.name}),s.id>1e12&&e.jsx("small",{className:"badge bg-primary ms-1",children:"NUEVO"})]})]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-light text-dark",children:s.category})}),e.jsx("td",{children:e.jsxs("span",{className:"fw-bold text-success",children:["$",s.price]})}),e.jsx("td",{children:void 0!==s.stock?e.jsx("span",{className:"badge "+(s.stock>0?"bg-success":"bg-warning text-dark"),children:s.stock>0?`${s.stock} unidades`:"Sin stock"}):e.jsx("span",{className:"badge bg-secondary",children:"No definido"})}),e.jsx("td",{children:e.jsxs("div",{className:"btn-group",role:"group",children:[e.jsx(l,{variant:"outline-primary",size:"sm",onClick:()=>(e=>{B("edit"),I(e),F(!0)})(s),title:"Editar producto",children:e.jsx("i",{className:"bi bi-pencil"})}),N(s.id)&&e.jsx(l,{variant:"outline-danger",size:"sm",onClick:()=>(e=>{E(e),S(!0)})(s),title:"Eliminar producto",children:e.jsx("i",{className:"bi bi-trash"})})]})})]},s.id))})]})})}),e.jsx(d.Footer,{className:"bg-light text-center",children:e.jsxs("small",{className:"text-muted",style:{fontFamily:"Quicksand, sans-serif"},children:["Mostrando 10 de ",n.length," productos"]})})]})})}),e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsxs(d,{className:"border-0 shadow-sm",children:[e.jsx(d.Header,{className:"bg-white",children:e.jsx("h5",{className:"mb-0",style:{fontFamily:"Lato, sans-serif"},children:"Acciones Rápidas"})}),e.jsx(d.Body,{children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs(l,{variant:"outline-primary",className:"w-100 py-3",onClick:()=>alert("Funcionalidad en desarrollo"),children:[e.jsx("i",{className:"bi bi-file-earmark-text d-block mb-2",style:{fontSize:"2rem"}}),"Generar Reporte"]})}),e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs(l,{variant:"outline-success",className:"w-100 py-3",onClick:()=>v(),children:[e.jsx("i",{className:"bi bi-arrow-clockwise d-block mb-2",style:{fontSize:"2rem"}}),"Actualizar Datos"]})}),e.jsx("div",{className:"col-md-4 mb-3",children:e.jsxs(l,{variant:"outline-warning",className:"w-100 py-3",onClick:()=>alert("Funcionalidad en desarrollo"),children:[e.jsx("i",{className:"bi bi-gear d-block mb-2",style:{fontSize:"2rem"}}),"Configuración"]})})]})})]})})})]})})}),e.jsxs(o,{show:k,onHide:()=>F(!1),size:"lg",centered:!0,backdrop:"static",children:[e.jsx(o.Header,{closeButton:!0,children:e.jsxs(o.Title,{style:{fontFamily:"Lato, sans-serif"},children:[e.jsx("i",{className:`bi ${"edit"===W?"bi-pencil-square":"bi-plus-circle"} me-2`}),"edit"===W?"Editar Producto":"Agregar Nuevo Producto"]})}),e.jsx(o.Body,{className:"p-4",children:e.jsx(f,{mode:W,editProduct:z,onClose:()=>{F(!1),I(null),B("add")}})})]}),e.jsx(h,{position:"top-end",className:"p-3",children:e.jsxs(x,{show:w,onClose:()=>C(!1),delay:4e3,autohide:!0,bg:"success",children:[e.jsxs(x.Header,{children:[e.jsx("i",{className:"bi bi-check-circle-fill text-success me-2"}),e.jsx("strong",{className:"me-auto",children:"edit"===W?"Producto Actualizado":"Producto Agregado"})]}),e.jsxs(x.Body,{className:"text-white",children:[e.jsx("strong",{children:T?.name})," se procesó exitosamente."]})]})}),e.jsx(g,{show:P,onHide:()=>{S(!1),E(null)},onConfirm:async()=>{if(Q){L(!0);try{await new Promise(e=>setTimeout(e,1e3)),y(Q.id),C(!0),D({name:Q.name}),setTimeout(()=>C(!1),3e3)}catch(e){}finally{L(!1),S(!1),E(null)}}},productName:Q?.name||Q?.title||"",isDeleting:A})]})]})}},Symbol.toStringTag,{value:"Module"}));export{j as E,u as S,y as i,b as u};
